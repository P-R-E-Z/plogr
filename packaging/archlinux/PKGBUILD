# Maintainer: Prez <154857421+P-R-E-Z@users.noreply.github.com>
pkgname=plogr
pkgver=0.7.0
pkgrel=1
pkgdesc="Cross-platform package installation logger"
arch=('any')
url="https://github.com/P-R-E-Z/plogr"
license=('MIT')
depends=('python' 'python-pydantic' 'python-rich' 'python-click' 'python-watchdog' 'python-appdirs' 'python-toml')
makedepends=('python-build' 'python-installer' 'python-setuptools' 'python-wheel')
source=("$pkgname-$pkgver.tar.gz::$url/archive/v$pkgver.tar.gz")
sha256sums=('SKIP')

build() {
    cd "$srcdir/$pkgname-$pkgver"
    python -m build --wheel --no-isolation
}

package() {
    cd "$srcdir/$pkgname-$pkgver"
    install -D -m0644 "dist/"*.whl "$pkgdir/tmp.whl"
    python -m installer --destdir="$pkgdir" "$pkgdir/tmp.whl"

    # Install hook
    install -D -m0755 "packaging/archlinux/plogr-hook.sh" "$pkgdir/usr/share/plogr/plogr-hook.sh"
    install -D -m0644 "packaging/archlinux/plogr.hook" "$pkgdir/usr/share/libalpm/hooks/plogr.hook"
} 